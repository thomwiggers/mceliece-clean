--- a/decrypt.c	
+++ b/decrypt.c	
@@ -69,7 +69,7 @@
 
 	//
 
-	check = w;
+	check = (uint16_t)w;
 	check ^= SYS_T;
 
 	for (i = 0; i < SYS_T*2; i++)
